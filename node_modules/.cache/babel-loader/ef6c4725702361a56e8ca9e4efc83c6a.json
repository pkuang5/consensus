{"ast":null,"code":"var _jsxFileName = \"/Users/zionwang/Projects/consensus/src/components/search.js\";\nimport React, { useState, useEffect } from \"react\";\nimport yelpREST from \"../api/yelp\";\nimport database from '../firebase';\nimport Loader from \"./loader\";\nimport { useHistory } from 'react-router-dom';\n\nfunction Search(props) {\n  let history = useHistory();\n  const [loading, setLoading] = useState(false);\n\n  async function populateBusinessesAndSetGroupCode(location, term) {\n    setLoading(true);\n    await yelpREST(\"/businesses/search\", {\n      params: {\n        location: location,\n        term: term,\n        limit: 10\n      }\n    }).then(({\n      data\n    }) => {\n      let {\n        businesses\n      } = data;\n      var code = Math.floor(Math.random() * Math.floor(10000));\n      businesses.reduce(async (memo, b) => {\n        await memo;\n        await yelpREST(`/businesses/${b.id}`).then(({\n          data\n        }) => {\n          var item = {\n            id: data.id,\n            name: data.name,\n            photos: data.photos,\n            lat: data.coordinates.latitude,\n            lng: data.coordinates.longitude\n          };\n          database.ref(`groups/${code}/${b.id}`).set(item);\n          database.ref(`groups/${code}/${b.id}/vote`).set(0);\n        });\n      }, undefined).then(() => {\n        setLoading(false);\n        history.push(`/${code}`);\n      });\n    });\n  }\n\n  if (loading) return /*#__PURE__*/React.createElement(Loader, {\n    loading: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 23\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"flex p-6 max-w-md mx-auto mt-10 bg-gray-100 rounded-lg shadow-xl\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ml-6 pt-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"text-2xl text-blue-700 leading-tight\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 11\n    }\n  }, \"Business Search\"), /*#__PURE__*/React.createElement(\"input\", {\n    class: \"border rounded-md\",\n    placeholder: \"location\",\n    id: \"location\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    class: \"border rounded-md\",\n    placeholder: \"category\",\n    id: \"category\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    class: \"w-24 h-10 bg-blue-600 text-white\",\n    onClick: () => populateBusinessesAndSetGroupCode(document.getElementById(\"location\").value, document.getElementById(\"category\").value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 11\n    }\n  }, \"Submit\"))));\n}\n\nexport default Search;","map":{"version":3,"sources":["/Users/zionwang/Projects/consensus/src/components/search.js"],"names":["React","useState","useEffect","yelpREST","database","Loader","useHistory","Search","props","history","loading","setLoading","populateBusinessesAndSetGroupCode","location","term","params","limit","then","data","businesses","code","Math","floor","random","reduce","memo","b","id","item","name","photos","lat","coordinates","latitude","lng","longitude","ref","set","undefined","push","document","getElementById","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport yelpREST from \"../api/yelp\";\nimport database from '../firebase'\nimport Loader from \"./loader\"\nimport { useHistory } from 'react-router-dom'\n\nfunction Search(props) {\n\n  let history = useHistory()\n\n  const [loading, setLoading] = useState(false)\n\n  async function populateBusinessesAndSetGroupCode(location, term) {\n    setLoading(true)\n    await yelpREST(\"/businesses/search\", {\n      params: {\n        location: location,\n        term: term,\n        limit: 10,\n      },\n    }).then(({ data }) => {\n      let { businesses } = data;\n      var code = Math.floor(Math.random() * Math.floor(10000))\n\n      businesses.reduce(async (memo, b) => {\n        await memo\n        await yelpREST(`/businesses/${b.id}`).then(({ data }) => {\n          var item = {\n            id: data.id,\n            name: data.name,\n            photos: data.photos,\n            lat: data.coordinates.latitude,\n            lng: data.coordinates.longitude\n          }\n          database.ref(`groups/${code}/${b.id}`).set(item)\n          database.ref(`groups/${code}/${b.id}/vote`).set(0)\n        })\n      }, undefined).then(() => {\n        setLoading(false)\n        history.push(`/${code}`)\n      }\n      )\n    })\n  }\n\n  if (loading) return <Loader loading={true} />\n\n  return (\n    <div>\n      <div class=\"flex p-6 max-w-md mx-auto mt-10 bg-gray-100 rounded-lg shadow-xl\">\n        <div className=\"ml-6 pt-1\">\n          <h1 className=\"text-2xl text-blue-700 leading-tight\">\n            Business Search\n          </h1>\n          <input\n            class=\"border rounded-md\"\n            placeholder=\"location\"\n            id=\"location\"\n          ></input>\n          <input\n            class=\"border rounded-md\"\n            placeholder=\"category\"\n            id=\"category\"\n          ></input>\n          <button\n            class=\"w-24 h-10 bg-blue-600 text-white\"\n            onClick={() =>\n              populateBusinessesAndSetGroupCode(\n                document.getElementById(\"location\").value,\n                document.getElementById(\"category\").value\n              )\n            }\n          >\n            Submit\n          </button>\n          {/* <JoinCode \n            onJoinCode={(code) => props.onSetGroupCode(code)}\n            populateBusinesses={(businesses) => props.populateBusinesses(businesses)}\n          /> */}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Search;\n"]},"metadata":{},"sourceType":"module"}